<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>第8章 库存决策 - 交互式教程</title>
    
    <!-- MathJax 配置 -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$','$'], ['\\(','\\)']],
                displayMath: [['$$','$$'], ['\\[','\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            "HTML-CSS": {
                availableFonts: ["TeX"],
                linebreaks: { automatic: true }
            }
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans SC', sans-serif;
            line-height: 1.8;
            color: #343434;
            background: linear-gradient(135deg, #ffffff 0%, #f7f7f7 100%);
        }
        
        /* 导航栏 */
        nav {
            background: linear-gradient(135deg, #f27d00 0%, #ff9a3c 100%);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        nav h1 {
            color: #ffffff;
            font-size: 1.8rem;
            font-weight: 700;
        }
        
        /* 侧边栏导航 */
        .sidebar {
            position: fixed;
            left: 0;
            top: 80px;
            width: 250px;
            height: calc(100vh - 80px);
            background: #ffffff;
            padding: 2rem 1rem;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .sidebar h3 {
            color: #f27d00;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .sidebar ul {
            list-style: none;
        }
        
        .sidebar li {
            margin-bottom: 0.8rem;
        }
        
        .sidebar a {
            color: #343434;
            text-decoration: none;
            display: block;
            padding: 0.5rem;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        
        .sidebar a:hover {
            background: #a6d6c9;
            color: #ffffff;
            transform: translateX(5px);
        }
        
        /* 主内容区 */
        .container {
            margin-left: 270px;
            padding: 2rem;
            max-width: 1200px;
        }
        
        /* 章节样式 */
        section {
            background: #ffffff;
            margin-bottom: 2rem;
            padding: 2.5rem;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        section:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        h2 {
            color: #f27d00;
            font-size: 2rem;
            margin-bottom: 1.5rem;
            border-bottom: 3px solid #f7d117;
            padding-bottom: 0.5rem;
        }
        
        h3 {
            color: #343434;
            font-size: 1.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            background: linear-gradient(90deg, #a6d6c9 0%, transparent 100%);
            padding: 0.8rem;
            border-left: 5px solid #f27d00;
        }
        
        h4 {
            color: #f27d00;
            font-size: 1.2rem;
            margin-top: 1.5rem;
            margin-bottom: 0.8rem;
        }
        
        p {
            margin-bottom: 1rem;
            text-indent: 2em;
        }
        
        /* 公式样式 */
        .formula-box {
            background: linear-gradient(135deg, #f7f7f7 0%, #ffffff 100%);
            border-left: 5px solid #f7d117;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 10px;
            overflow-x: auto;
        }
        
        .mjx-chtml {
            font-size: 1.1em !important;
        }
        
        /* 例题样式 */
        .example {
            background: linear-gradient(135deg, #fff8e1 0%, #ffffff 100%);
            border: 2px solid #f7d117;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }
        
        .example-title {
            color: #f27d00;
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }
        
        .solution {
            background: #ffffff;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
        }
        
        .solution-title {
            color: #343434;
            font-weight: 700;
            margin-bottom: 0.8rem;
        }
        
        /* 图表样式 */
        .diagram {
            text-align: center;
            margin: 2rem 0;
            padding: 1.5rem;
            background: #f7f7f7;
            border-radius: 10px;
        }
        
        .diagram-caption {
            color: #343434;
            font-style: italic;
            margin-top: 1rem;
        }
        
        /* 折叠面板 */
        details {
            background: #f7f7f7;
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        details:hover {
            background: #a6d6c9;
        }
        
        summary {
            font-weight: 700;
            color: #f27d00;
            font-size: 1.1rem;
            padding: 0.5rem;
            user-select: none;
        }
        
        details[open] {
            background: #ffffff;
            border: 2px solid #a6d6c9;
        }
        
        details[open] summary {
            margin-bottom: 1rem;
            border-bottom: 2px solid #f7d117;
            padding-bottom: 0.5rem;
        }
        
        /* 重点提示 */
        .highlight {
            background: linear-gradient(90deg, #f7d117 0%, transparent 100%);
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            font-weight: 500;
        }
        
        /* 按钮样式 */
        .btn {
            background: linear-gradient(135deg, #f27d00 0%, #ff9a3c 100%);
            color: #ffffff;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(242, 125, 0, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(242, 125, 0, 0.4);
        }
        
        /* 表格样式 */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: #ffffff;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        th {
            background: linear-gradient(135deg, #f27d00 0%, #ff9a3c 100%);
            color: #ffffff;
            padding: 1rem;
            text-align: center;
            font-weight: 600;
        }
        
        td {
            padding: 1rem;
            border-bottom: 1px solid #f0f0f0;
            text-align: center;
        }
        
        tr:hover {
            background: #f7f7f7;
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .container {
                margin-left: 0;
                padding: 1rem;
            }
            
            nav h1 {
                font-size: 1.3rem;
            }
            
            h2 {
                font-size: 1.5rem;
            }
        }
        
        /* 滚动条样式 */
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f0f0f0;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #f27d00 0%, #ff9a3c 100%);
            border-radius: 5px;
        }
        
        /* 练习题样式 */
        .exercise {
            background: linear-gradient(135deg, #e8f5f1 0%, #ffffff 100%);
            border: 2px solid #a6d6c9;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }
        
        .exercise-title {
            color: #343434;
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav>
        <h1>📦 第8章 库存决策 - 管理科学基础</h1>
    </nav>
    
    <!-- 侧边栏导航 -->
    <div class="sidebar" id="sidebar">
        <h3>目录导航</h3>
        <ul>
            <li><a href="#section1">8.1 库存决策的基本概念</a></li>
            <li><a href="#section2">8.2 确定型库存模型</a></li>
            <li><a href="#section2-1">　8.2.1 EOQ模型</a></li>
            <li><a href="#section2-2">　8.2.2 在制品批量模型</a></li>
            <li><a href="#section2-3">　8.2.3 允许缺货模型</a></li>
            <li><a href="#section2-4">　8.2.4 生产需一定时间模型</a></li>
            <li><a href="#section3">8.3 随机型库存模型</a></li>
            <li><a href="#section3-1">　8.3.1 单时期无准备成本</a></li>
            <li><a href="#section3-2">　8.3.2 s-S策略</a></li>
            <li><a href="#section3-3">　8.3.3 随机需求与补充</a></li>
            <li><a href="#exercises">📝 习题练习</a></li>
        </ul>
    </div>
    
    <!-- 主内容区 -->
    <div class="container">
        <!-- 8.1 库存决策的基本概念 -->
        <section id="section1">
            <h2>8.1 库存决策的基本概念</h2>
            
            <p>库存决策又称存贮论，是管理技术中的一个重要分文。在生产活动及日常生活中经常发生供应和需求之间不协调的情况。物资储存（即库存）就是解决和协调供应和需求之间矛盾的一种手段。如工厂为了避免由于原料供应不足而停工，就必须储备一定数量的原料；商店为了避免商品脱销也必须储备一定量的商品。无论是营利单位，或者是非营利单位，物资的储存是极普遍的现象。例如：水库储备一定量的水，以备旱季使用；银行储备一定量现金，保证提款的需要；血库储备一定量血液，为抢救病人备用；军队储备一定量军需品及弹药，以备一旦敌人发动战争能予以反击；家庭储备一定量粮食和食品，以备日常生活所需。</p>
            
            <p>然而，库存物资是否越多越好？工厂生产过程中原料储存越多，停工待料现象就越少，从而减少停工引起的损失。但是，原料储存过多相应储存费用也增加，同时又占用了大量的流动资金，造成经济损失。一般来讲，库存量不足会造成缺货损失，而库存量过大又会造成物质积压，库存费用增大，流动资金占用过大。因此，如何制定一个合理的库存控制方针，使缺货风险和库存过多之间得以平衡，是存贮论要研究和解决的主要问题。库存控制方针首先就是要解决：库存物资每次补充多少，库存物资隔多少时间补充一次？</p>
            
            <p>为了解决这两个问题，一般是对所研究的实际储存系统建立一个相应的模型，由此模型的分析和研究得出最佳的库存方针。评价库存方案的优劣，通常是以与这库存方案相应的成本费用大小作标准。对一个企业来讲，实际库存工作是由两方面组成，其一是日常物资储存的收、发、存等具体工作，账目的计算和记录，各种数据和档案的保管工作可以由电子计算机进行，其二是确定合理的订购时间和订购数量。存贮论的研究主要是针对第二方面工作的。</p>
            
            <div class="diagram">
                <p style="text-align:left; padding: 1rem;">
                    <strong>图 8.1 一般储存系统模型</strong><br><br>
                    供应（输入）→ [库存] → 需求（输出）<br>
                    　　　　　　　　↓储存系统↓
                </p>
                <p class="diagram-caption">图 8.1 显示了库存系统的基本结构</p>
            </div>
            
            <p>图 8.1 表示一般储存系统模型。在讨论具体模型前，先引入一些有关储存系统的基本概念。</p>
            
            <details>
                <summary>💡 点击展开：库存系统的基本要素</summary>
                <div style="padding: 1rem;">
                    <h4>1. 需求</h4>
                    <p>需求是指对某种储存物资的需要，用单位时间内对这种物资的需求量进行描述，需求是储存系统的输出。需求可以是均匀连续的，也可以是间断的；需求量可以是确定的，也可以是随机的。</p>
                    
                    <h4>2. 补充</h4>
                    <p>存储量由于需求输出而不断减少，必须加以补充。补充就是储存系统的输入。补充的方式有订货或生产。补充可以是瞬时进行，也可以是均匀进行。</p>
                    <ul style="list-style-position: inside;">
                        <li>1) 批量：补充（输入）往往采用以一定数量为一批的方式进行，每一批补充数量为批量。</li>
                        <li>2) 补充间隔：两次补充之间的时间。</li>
                        <li>3) 提前期（拖后期）：从提出订货到收到订货之间的时间间隔。提前期可以是确定的，也可以是随机的。</li>
                    </ul>
                </div>
            </details>
            
            <details>
                <summary>💡 点击展开：储存系统的费用</summary>
                <div style="padding: 1rem;">
                    <h4>3. 储存系统的费用</h4>
                    <p><strong>1) 储存费用</strong>　这包含仓库保管费用，占用流动资金利息，储存物资的变质损失等等，以单位储存物资在单位时间内所需的费用计算。</p>
                    
                    <p><strong>2) 准备费用</strong>　这是指每一次订货或每组织一次生产所必须的固定费用，例如每次订货的手续费，出差费等，每次生产的准备，结束费等。它与订货数量或生产数量无关。</p>
                    
                    <p><strong>3) 货物成本费用（生产可变成本费用）</strong>　它是指货物本身的价格，或者是与生产产品数量有关的可变成本费用。</p>
                    
                    <p><strong>4) 缺货损失费用</strong>　因库存量不足，发生供不应求而造成的利润损失。例如商品缺货丢失销售机会的损失，停工待料的损失以及不能履行合同的罚款。</p>
                </div>
            </details>
            
            <details>
                <summary>💡 点击展开：储存策略类型</summary>
                <div style="padding: 1rem;">
                    <h4>4. 储存策略</h4>
                    <p>决定多少时间补充一次以及每次补充多少的策略。通常有三种类型。</p>
                    <ul style="list-style-position: inside;">
                        <li>1) $t$ 循环策略　每隔 $t$ 时间补充存储量 $Q$。</li>
                        <li>2) $(s,S)$ 策略　每当储存量下降至 $s$ 时，即刻补充，使储存量达 $S$。</li>
                        <li>3) $(t,s,S)$ 混合策略　每隔 $t$ 时间检查库存量 $x$。当 $x>s$ 不补充；当 $x \leq s$ 时进行补充，使库存量达到 $S$。</li>
                    </ul>
                </div>
            </details>
            
            <div class="highlight">
                <strong>重要提示：</strong>为了确定一个储存系统的最佳储存策略，首先对实际储存系统建立相应的数学模型。这模型既要不太复杂又要能反映出实际系统的主要本质特点。长期以来人们已建立了许多有效的储存模型。这些模型根据数据（例如需求量、提前期等）是确定的还是随机的，可分成两大类：一类为确定型储存模型；另一类是随机型储存模型。
            </div>
        </section>
        
        <!-- 8.2 确定型库存模型 -->
        <section id="section2">
            <h2>8.2 确定型库存模型</h2>
            
            <p>本节讨论的三个库存模型中的参数，例如需求量、提前期等都是确定的。这类模型是将复杂的实际情况简化了，所以便于分析。在这些模型讨论中，评价一个储存策略优劣的数量指标是这个储存策略产生的总费用。所谓最佳储存策略就是使总费用最小的策略。</p>
            
            <!-- 8.2.1 EOQ模型 -->
            <h3 id="section2-1">8.2.1 经济批量 EOQ 库存模型（模型 1）</h3>
            
            <p>这个模型假设：</p>
            <p>① 需求量是均匀、连续的，单位时间内需求量是常数 $R$，则 $t$ 时间内需求量是 $Rt$；</p>
            <p>② 提前期为零，补充是瞬时的，即一订货即刻就能得到补充，每次补充量 $Q$ 是不变的，这意味着，需要时马上就可以补充，因此不发生缺货现象。</p>
            
            <p>这个模型可用图 8.2 表示。由图 8.2 得知，每补充一批货物 $Q$，库存量即刻由零上升至 $Q$，然后以 $R$ 的速率均匀消耗。库存量沿斜线下降，一旦库存量降至零时，立即再次补充 $Q$，如此不断重复。</p>
            
            <div class="diagram">
                <svg width="400" height="250" style="margin: 0 auto; display: block;">
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#343434" />
                        </marker>
                    </defs>
                    <!-- 坐标轴 -->
                    <line x1="50" y1="200" x2="380" y2="200" stroke="#343434" stroke-width="2" marker-end="url(#arrowhead)"/>
                    <line x1="50" y1="200" x2="50" y2="30" stroke="#343434" stroke-width="2" marker-end="url(#arrowhead)"/>
                    <text x="385" y="205" font-size="14">时间</text>
                    <text x="30" y="25" font-size="14">库存量</text>
                    
                    <!-- 锯齿波形 -->
                    <line x1="50" y1="200" x2="50" y2="80" stroke="#f27d00" stroke-width="3"/>
                    <line x1="50" y1="80" x2="130" y2="200" stroke="#f27d00" stroke-width="3"/>
                    <line x1="130" y1="200" x2="130" y2="80" stroke="#f27d00" stroke-width="3"/>
                    <line x1="130" y1="80" x2="210" y2="200" stroke="#f27d00" stroke-width="3"/>
                    <line x1="210" y1="200" x2="210" y2="80" stroke="#f27d00" stroke-width="3"/>
                    <line x1="210" y1="80" x2="290" y2="200" stroke="#f27d00" stroke-width="3"/>
                    
                    <!-- 标注 -->
                    <text x="20" y="85" font-size="16" fill="#f27d00">Q</text>
                    <text x="80" y="220" font-size="14">t</text>
                    <line x1="50" y1="210" x2="130" y2="210" stroke="#343434" stroke-width="1" stroke-dasharray="5,5"/>
                    <line x1="50" y1="210" x2="50" y2="200" stroke="#343434" stroke-width="2"/>
                    <line x1="130" y1="210" x2="130" y2="200" stroke="#343434" stroke-width="2"/>
                    
                    <!-- 斜率标注 -->
                    <text x="90" y="100" font-size="12" fill="#343434">斜率为-R</text>
                </svg>
                <p class="diagram-caption">图 8.2 EOQ模型的库存量变化图</p>
            </div>
            
            <div class="formula-box">
                <p>在图中，关键参数定义如下：</p>
                <p>$t$ ——订货间隔时间，$t = \frac{Q}{R}$；</p>
                <p>$C_3$ ——每次订货准备费用；</p>
                <p>$K$ ——货物单价；</p>
                <p>$C_1$ ——单位时间内单位货物的储存费。</p>
                <p>$t$ 时间内平均库存量为</p>
                $$\frac{1}{t}\int_0^t RTdT = \frac{1}{2}Rt = \frac{1}{2}Q$$
            </div>
            
            <p>从而导出作为订货量 $Q$ 的函数的平均总费用</p>
            
            <div class="formula-box">
                $$C(Q) = (\text{准备费用} + \text{货价} + \text{储存费用})/\text{时间 }t$$
                $$= (C_3 + KQ + C_1 \cdot \frac{1}{2}Rt^2)/t$$
                $$= \frac{(C_3 + KQ)}{Q/R} + \frac{1}{2}C_1Q$$
                $$= \frac{C_3R}{Q} + KR + \frac{1}{2}C_1Q$$
            </div>
            
            <p>为求 $\min C(Q)$，求导数</p>
            <div class="formula-box">
                $$\frac{dC(Q)}{dQ} = -\frac{C_3R}{Q^2} + \frac{C_1}{2} = 0$$
            </div>
            
            <p>即得最佳定货量</p>
            <div class="formula-box">
                $$Q^* = \sqrt{\frac{2C_3R}{C_1}}$$
            </div>
            
            <p>可进一步通过计算 $C(Q)$ 的二阶导数证明 $Q^*$ 是极小点。这就是著名的<strong>经济批量（Economic Ordering Quantity）公式，简称 EOQ 公式</strong>。由此同时得出最佳订货时间间隔</p>
            
            <div class="formula-box">
                $$t^* = Q^*/R = \sqrt{\frac{2C_3}{C_1R}}$$
            </div>
            
            <!-- 例题 8.1 -->
            <div class="example">
                <div class="example-title">📌 例 8.1</div>
                <p>设某产品年需求量为 144 件，且需求是均匀的，每生产一批产品（不管产量多少）需准备费用 90 元，每生产一件产品的直接成本为 100 元，库存费用为每件每年 20 元。试决定每批生产的最佳数量。</p>
                
                <div class="solution">
                    <div class="solution-title">💡 解答</div>
                    <p>需求量 $R = 144$ 件/年，准备费用 $C_3 = 90$ 元；生产一件产品直接成本 $K = 100$ 元；每件每年库存费用 $C_1 = 20$ 元/件·年；每次生产量为 $Q$。使用 EOQ 公式，得</p>
                    <div class="formula-box">
                        $$Q^* = \sqrt{\frac{2C_3R}{C_1}} = \sqrt{\frac{2 \times 90 \times 144}{20}} = 36(\text{件})$$
                    </div>
                    <p>最低费用（年平均总费用）</p>
                    <div class="formula-box">
                        $$C(Q) = \frac{C_3R}{Q} + KR + \frac{1}{2}C_1Q$$
                        $$= \frac{90 \times 144}{36} + 100 \times 144 + \frac{1}{2} \times 20 \times 36$$
                        $$= 15\ 120 \text{ 元}$$
                    </div>
                </div>
            </div>
            
            <!-- 8.2.2 在制品批量模型 -->
            <h3 id="section2-2">8.2.2 在制品批量的库存模型（模型 2）</h3>
            
            <p>本模型假设条件，除了储存补充是以 $P$ 速度进行外，其余与模型 1 相同。</p>
            
            <p>本模型最典型的例子是描述生产过程中两工序之间需要一定数量的在制品，而上下工序的生产速率并不同步，上工序供应不能发生短缺，才能保证下工序连续进行，这就要求上工序生产速度 $P$ 要大于下工序的需求速度 $R$。它的生产过程如图 8.3 描述。</p>
            
            <div class="diagram">
                <svg width="450" height="250" style="margin: 0 auto; display: block;">
                    <defs>
                        <marker id="arrowhead2" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#343434" />
                        </marker>
                    </defs>
                    <!-- 坐标轴 -->
                    <line x1="50" y1="200" x2="420" y2="200" stroke="#343434" stroke-width="2" marker-end="url(#arrowhead2)"/>
                    <line x1="50" y1="200" x2="50" y2="30" stroke="#343434" stroke-width="2" marker-end="url(#arrowhead2)"/>
                    <text x="425" y="205" font-size="14">时间</text>
                    <text x="20" y="25" font-size="14">库存量</text>
                    
                    <!-- 锯齿波形 - 上升较陡，下降较缓 -->
                    <line x1="50" y1="200" x2="110" y2="70" stroke="#f27d00" stroke-width="3"/>
                    <line x1="110" y1="70" x2="220" y2="200" stroke="#f27d00" stroke-width="3"/>
                    <line x1="220" y1="200" x2="280" y2="70" stroke="#f27d00" stroke-width="3"/>
                    <line x1="280" y1="70" x2="390" y2="200" stroke="#f27d00" stroke-width="3"/>
                    
                    <!-- 标注 -->
                    <text x="85" y="220" font-size="14">T</text>
                    <text x="170" y="220" font-size="14">B</text>
                    <text x="30" y="205" font-size="14">O</text>
                    
                    <!-- 时间标记 -->
                    <line x1="50" y1="210" x2="110" y2="210" stroke="#343434" stroke-width="1" stroke-dasharray="5,5"/>
                    <line x1="50" y1="210" x2="50" y2="200" stroke="#343434" stroke-width="2"/>
                    <line x1="110" y1="210" x2="110" y2="200" stroke="#343434" stroke-width="2"/>
                    <line x1="220" y1="210" x2="220" y2="200" stroke="#343434" stroke-width="2"/>
                    
                    <!-- 斜率标注 -->
                    <text x="150" y="180" font-size="12" fill="#343434" transform="rotate(-15 150 180)">斜率=-R</text>
                </svg>
                <p class="diagram-caption">图 8.3 在制品批量模型</p>
            </div>
            
            <p>开始时上工序以 $P$ 速度生产（即补充），同时下工序以 $R$ 速度消耗在制品，由于 $P > R$，在制品的储存量沿 $OA$ 斜线上升。当储存量达一定数量时，上工序停止生产，下工序仍不断消耗在制品，储存量以 $R$ 速度沿斜线 $AB$ 下降至零，这时上工序即刻开始生产（补充），如此不断重复。</p>
            
            <p>设上工序每次生产时间为 $T$，则每次生产批量 $Q = PT$。同时为了确定最佳生产批量 $Q^*$，首先需导出单位时间内总费用（平均费用）与批量 $Q$ 之间的关系。由图 8.3 分析可知，在 $[0,T]$ 区间内储存量以 $(P-R)$ 速度增长，在 $[T,t]$ 区间内存储量以 $R$ 速度下降，且有</p>
            
            <div class="formula-box">
                $$(P-R)T = R(t-T)$$
            </div>
            
            <p>即得</p>
            <div class="formula-box">
                $$T = \frac{Rt}{P}$$
            </div>
            
            <p>$t$ 时间内平均储存量为 $\frac{1}{2}(P-R)T$；$t$ 时间内储存费为 $\frac{1}{2}C_1(P-R)Tt$；每生产一次准备成本为 $C_3$。</p>
            
            <p>单位时间内总费用（平均费用）</p>
            <div class="formula-box">
                $$C(Q) = \frac{1}{t}[C_3 + KQ + \frac{1}{2}C_1(P-R)Tt]$$
                $$= \frac{R}{Q}[C_3 + KQ + \frac{1}{2}C_1(P-R)\frac{R \cdot (\frac{Q}{R})^2}{P}]$$
                $$= \frac{C_3R}{Q} + KR + \frac{1}{2}C_1\frac{P-R}{P}RQ$$
            </div>
            
            <p>进一步计算得</p>
            <div class="formula-box">
                $$\frac{dC(Q)}{dQ} = -\frac{C_3R}{Q^2} + \frac{1}{2}C_1\frac{P-R}{P}R = 0$$
            </div>
            
            <p>由此得最佳批量</p>
            <div class="formula-box">
                $$Q^* = \sqrt{\frac{2C_3RP}{C_1(P-R)}}$$
            </div>
            
            <p>从而得最佳生产时间</p>
            <div class="formula-box">
                $$T^* = \frac{Q^*}{P} = \sqrt{\frac{2C_3R}{C_1P(P-R)}}$$
                $$t^* = \frac{P}{R}T^* = \sqrt{\frac{2C_3P}{C_1R(P-R)}}$$
            </div>
            
            <p>最大库存量</p>
            <div class="formula-box">
                $$S = Q^* - RT^* = \sqrt{\frac{2C_3R(P-R)}{C_1P}}$$
            </div>
            
            <p>与模型 1 相比较，可知当 $P \to \infty$ 时，$\frac{P}{P-R} \to 1$，模型 2 公式即成模型 1 中的经济批量公式。</p>
            
            <div class="highlight">
                <strong>💡 重要结论：</strong>事实上当生产速度 $P \to \infty$，意味着补充速度无限大，即为瞬时补充，模型 2 与模型 1 就完全一样了。
            </div>
            
            <!-- 例题 8.2 -->
            <div class="example">
                <div class="example-title">📌 例 8.2</div>
                <p>某厂每月需甲产品 100 件，每月生产率为 500 件，每批装配费为 5 元，每月每件产品储存费为 0.4 元，求最佳量及最低费用。</p>
                
                <div class="solution">
                    <div class="solution-title">💡 解答</div>
                    <p>已知 $C_3 = 5, C_1 = 0.4, P = 500, R = 100$ 代入公式，得</p>
                    <div class="formula-box">
                        $$Q^* = \sqrt{\frac{2C_3RP}{C_1(P-R)}} = \sqrt{3\ 125} \approx 56 \text{ 件}$$
                        $$C_0 = \sqrt{\frac{2C_1C_3R(P-R)}{P}} \approx 17.89 \text{ 元}$$
                    </div>
                </div>
            </div>
            
            <!-- 8.2.3 允许缺货模型 -->
            <h3 id="section2-3">8.2.3 允许发生缺货、生产时间很短的库存模型（模型 3）</h3>
            
            <p>本模型是在模型 1 的基础上考虑允许发生缺货的情况，即当库存由于需求而下降到零时，可以采取等一段时间再订货补充的策略。这样，在这一段时间内就发生缺货。一方面，由于需求得不到满足造成经济损失，要支付缺货费用；另一方面，由于采取这种策略，增长了订货间隔时间，减少了订货次数，以至减少准备费用，同时也减少了平均储存量，从而减少储存费用，从总费用角度看，采取缺货策略可能是有利的。</p>
            
            <div class="diagram">
                <svg width="450" height="280" style="margin: 0 auto; display: block;">
                    <defs>
                        <marker id="arrowhead3" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#343434" />
                        </marker>
                    </defs>
                    <!-- 坐标轴 -->
                    <line x1="50" y1="150" x2="420" y2="150" stroke="#343434" stroke-width="2" marker-end="url(#arrowhead3)"/>
                    <line x1="50" y1="200" x2="50" y2="30" stroke="#343434" stroke-width="2" marker-end="url(#arrowhead3)"/>
                    <text x="425" y="155" font-size="14">T</text>
                    <text x="25" y="25" font-size="14">Q</text>
                    <text x="40" y="155" font-size="14">O</text>
                    
                    <!-- 库存变化 - 带缺货 -->
                    <line x1="50" y1="150" x2="50" y2="60" stroke="#f27d00" stroke-width="3"/>
                    <line x1="50" y1="60" x2="130" y2="150" stroke="#f27d00" stroke-width="3"/>
                    <line x1="130" y1="150" x2="210" y2="230" stroke="#f27d00" stroke-width="3" stroke-dasharray="8,4"/>
                    <line x1="210" y1="230" x2="210" y2="60" stroke="#f27d00" stroke-width="3"/>
                    <line x1="210" y1="60" x2="290" y2="150" stroke="#f27d00" stroke-width="3"/>
                    
                    <!-- 标注 -->
                    <text x="30" y="65" font-size="14">S</text>
                    <line x1="40" y1="60" x2="50" y2="60" stroke="#343434" stroke-width="1" stroke-dasharray="3,3"/>
                    
                    <!-- 时间标记 -->
                    <text x="80" y="170" font-size="12">t₁</text>
                    <text x="160" y="170" font-size="12">t</text>
                    <text x="195" y="170" font-size="12">t₂</text>
                    
                    <line x1="130" y1="160" x2="130" y2="150" stroke="#343434" stroke-width="2"/>
                    <line x1="210" y1="160" x2="210" y2="150" stroke="#343434" stroke-width="2"/>
                </svg>
                <p class="diagram-caption">图 8.4 允许缺货的库存模型</p>
            </div>
            
            <p>模型 3 可用图 8.4 描述。其假设条件与模型 1 相同，并设单位时间内单位缺货费为 $C_2$。问题是如何去确定最佳的储存策略，即不仅要确定最优订货量 $Q$，而且要确定最优的拖延订货时间即缺货时间 $t_2$，使得单位时间内总费用（准备费用＋缺货费用）为最小。</p>
            
            <p>分析图 8.4 可看出，在 $t_1$ 时间间隔内库存量是正的，随着需求下降为零，在 $t_2$ 时间间隔内发生缺货，最大缺货量为 $Rt_2$，至 $t_2$ 间隔末订货 $Q$，补足缺货量 $Rt_2$，库存上升为 $(Q - Rt_2)$，如此重复。</p>
            
            <p>模型 3 描述的储存系统中，由于允许缺货，单位时间内总费用不仅依赖于订货批量（或订货间隔时间），而且依赖于缺货时间。也就是说，这平均总费用应是订货量 $Q$ 和缺货时间 $t_2$ 的函数。由图 8.4 可知，订货间隔时间 $t = \frac{Q}{R}$，$t = t_1 + t_2$；最大缺货量为 $Rt_2$，$Rt_2 = Q - Rt_1$；</p>
            
            <div class="formula-box">
                <p>$t_1$ 时间内平均储存量为 $\frac{1}{2}(Q - Rt_2)$；$t$ 时间内发生的存储费为 $\frac{C_1}{2R}(Q - Rt_2)^2$；$t_2$ 时间内平均缺货量为 $\frac{1}{2}Rt_2$，$t$ 时间内发生的缺货费为 $\frac{1}{2}C_2Rt_2^2$。</p>
                
                <p>由此得到单位时间内总费用</p>
                $$C(Q,t_2) = \frac{1}{t}[C_3 + \frac{1}{2R}C_1(Q - Rt_2)^2 + \frac{1}{2}C_2Rt_2^2]$$
                $$= \frac{R}{Q}[C_3 + \frac{1}{2R}C_1(Q - Rt_2)^2 + \frac{1}{2}C_2Rt_2^2]$$
            </div>
            
            <p>由多元函数极值条件，极小点 $(Q^*, t_2^*)$ 在梯度 $\text{grad } C(Q,t_2) = 0$ 处获得，即在</p>
            <div class="formula-box">
                $$\frac{\partial C(Q,t_2)}{\partial Q} = 0, \quad \frac{\partial C(Q,t_2)}{\partial t_2} = 0$$
            </div>
            
            <p>处获得，则有</p>
            <div class="formula-box">
                $$\frac{\partial C(Q,t_2)}{\partial t_2} = \frac{R}{Q}[-C_1(Q - Rt_2) + C_2Rt_2] = 0$$
                $$t_2 = \frac{C_1Q}{(C_1 + C_2)R}$$
                $$\frac{\partial C(Q,t_2)}{\partial Q} = -\frac{R}{Q^2}[C_3 + \frac{1}{2R}C_1(Q - Rt_2)^2 + \frac{1}{2}C_2Rt_2^2] + \frac{R}{Q} \cdot \frac{C_1}{R}(Q - Rt_2) = 0$$
            </div>
            
            <p>将 $t_2$ 值代入得最优批量</p>
            <div class="formula-box">
                $$Q^* = \sqrt{\frac{2C_3(C_1 + C_2)R}{C_1C_2}}$$
            </div>
            
            <p>从而得</p>
            <div class="formula-box">
                $$t_2^* = \sqrt{\frac{2C_1C_3}{C_2(C_1 + C_2)R}}$$
                $$t^* = \frac{Q^*}{R} = \sqrt{\frac{2C_3(C_1 + C_2)}{C_1C_2R}}$$
            </div>
            
            <p>在上述公式中，若将条件改为不允许缺货，即缺货费 $C_2 \to \infty$，则 $\frac{C_1 + C_2}{C_2} \to 1$，上述公式即趋向模型 1 之 EOQ 公式。</p>
            
            <!-- 例题 8.3 -->
            <div class="example">
                <div class="example-title">📌 例 8.3</div>
                <p>已知需求速度 $R = 100$ 件，$C_1 = 0.4$ 元，$C_2 = 0.15$ 元，$C_3 = 5$ 元，求最低单位时间总费用及最佳储存策略下最大库存量。</p>
                
                <div class="solution">
                    <div class="solution-title">💡 解答</div>
                    <p>用 $Q^* = \sqrt{\frac{2C_3(C_1 + C_2)R}{C_1C_2}}$ 及 $t_2^* = \sqrt{\frac{2C_1C_3}{C_2(C_1 + C_2)R}}$</p>
                    <p>代入 $C(Q,t_2)$ 中，得最低单位时间总费用</p>
                    <div class="formula-box">
                        $$C(Q^*, t_2^*) = \sqrt{\frac{2C_1C_2C_3R}{C_1 + C_2}} = \sqrt{\frac{2 \times 0.4 \times 0.15 \times 5 \times 100}{0.4 + 0.15}}$$
                        $$\approx 10.44 \text{ 元}$$
                    </div>
                    <p>最大库存量</p>
                    <div class="formula-box">
                        $$S = Q^* - t_2^*R$$
                        $$= \sqrt{\frac{2C_3(C_1 + C_2)R}{C_1C_2}} - \sqrt{\frac{2C_1C_3R}{C_2(C_1 + C_2)}}$$
                        $$= \sqrt{\frac{2C_2C_3R}{C_1(C_1 + C_2)}} = \sqrt{\frac{2 \times 0.15 \times 5 \times 100}{0.4(0.4 + 0.15)}} \approx 26 \text{ 件}$$
                    </div>
                </div>
            </div>
            
            <!-- 8.2.4 生产需一定时间的模型 -->
            <h3 id="section2-4">8.2.4 允许缺货（需补足缺货）、生产需一定时间的库存模型（模型 4）</h3>
            
            <p>假设条件除允许缺货生产需一定时间外，其余条件皆与模型 1 相同。其存贮变化如图 8.5 所示。</p>
            
            <div class="diagram">
                <svg width="500" height="300" style="margin: 0 auto; display: block;">
                    <defs>
                        <marker id="arrowhead4" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#343434" />
                        </marker>
                    </defs>
                    <!-- 坐标轴 -->
                    <line x1="50" y1="180" x2="480" y2="180" stroke="#343434" stroke-width="2" marker-end="url(#arrowhead4)"/>
                    <line x1="50" y1="250" x2="50" y2="30" stroke="#343434" stroke-width="2" marker-end="url(#arrowhead4)"/>
                    <text x="485" y="185" font-size="14">T</text>
                    <text x="25" y="25" font-size="14">Q</text>
                    <text x="30" y="185" font-size="14">O</text>
                    
                    <!-- 复杂的库存变化图 -->
                    <!-- 第一个周期 -->
                    <line x1="50" y1="250" x2="90" y2="250" stroke="#f27d00" stroke-width="3"/>
                    <line x1="90" y1="250" x2="155" y2="80" stroke="#f27d00" stroke-width="3"/>
                    <line x1="155" y1="80" x2="200" y2="180" stroke="#f27d00" stroke-width="3"/>
                    <line x1="200" y1="180" x2="245" y2="270" stroke="#f27d00" stroke-width="3" stroke-dasharray="8,4"/>
                    
                    <!-- 第二个周期开始 -->
                    <line x1="245" y1="270" x2="310" y2="100" stroke="#f27d00" stroke-width="3"/>
                    <line x1="310" y1="100" x2="355" y2="200" stroke="#f27d00" stroke-width="3"/>
                    
                    <!-- S线 -->
                    <line x1="40" y1="80" x2="480" y2="80" stroke="#343434" stroke-width="1" stroke-dasharray="5,5"/>
                    <text x="20" y="85" font-size="14">S</text>
                    
                    <!-- B线 -->
                    <line x1="40" y1="270" x2="245" y2="270" stroke="#343434" stroke-width="1" stroke-dasharray="5,5"/>
                    <text x="20" y="275" font-size="14">B</text>
                    
                    <!-- 时间标记 -->
                    <text x="110" y="200" font-size="12">t₁</text>
                    <text x="175" y="200" font-size="12">t₂</text>
                    <text x="220" y="200" font-size="12">t₃</text>
                    
                    <line x1="90" y1="190" x2="90" y2="180" stroke="#343434" stroke-width="2"/>
                    <line x1="155" y1="190" x2="155" y2="180" stroke="#343434" stroke-width="2"/>
                    <line x1="200" y1="190" x2="200" y2="180" stroke="#343434" stroke-width="2"/>
                    <line x1="245" y1="190" x2="245" y2="180" stroke="#343434" stroke-width="2"/>
                    
                    <!-- 斜率标注 -->
                    <text x="100" y="120" font-size="11" fill="#343434">存贮以P-R速度增加</text>
                    <text x="120" y="60" font-size="11" fill="#343434">斜率=P-R</text>
                    <text x="160" y="230" font-size="11" fill="#343434">斜率=-R</text>
                </svg>
                <p class="diagram-caption">图 8.5 允许缺货且生产需一定时间的库存模型</p>
            </div>
            
            <div style="background: #f7f7f7; padding: 1.5rem; border-radius: 10px; margin: 1.5rem 0;">
                <p style="text-indent: 0;">取 $[0,t]$ 为一个周期，设 $t_1$ 时刻开始生产。</p>
                <p style="text-indent: 0;">$[0,t_2]$ 时间内存贮为零，$B$ 表示最大缺货量。</p>
                <p style="text-indent: 0;">$[t_1,t_2]$ 时间内除满足需求外，还要补足 $[0,t_1]$ 时间内的缺货。</p>
                <p style="text-indent: 0;">$[t_2,t_3]$ 时间内满足需求后的产品进入存贮，存贮量以 $(P-R)$ 速度增加。$S$ 表示存贮量，$t_3$ 时刻存贮量达到最大，$t_3$ 时刻停止生产。</p>
                <p style="text-indent: 0;">$[t_3,t]$ 时间存贮量以需求速度 $R$ 减少。</p>
            </div>
            
            <p>由图 8.5 易知：</p>
            <p>最大缺货量 $B = Rt_1$，或 $B = (P-R)(t_2 - t_1)$。即</p>
            <div class="formula-box">
                $$Rt_1 = (P-R)(t_2 - t_1), \text{得}$$
                $$t_1 = \frac{(P-R)}{P}t_2$$
            </div>
            
            <p>最大存贮量 $S = (P-R)(t_3 - t_2)$ 或 $S = R(t - t_3)$。即 $(P-R)(t_3 - t_2) = R(t - t_3)$，得</p>
            <div class="formula-box">
                $$t_3 = \frac{R}{P}t + (1 - \frac{R}{P})t_2, \text{或}$$
                $$t_3 - t_2 = \frac{R}{P}(t - t_2)$$
            </div>
            
            <p>在 $[0,t]$ 时间内所需费用：</p>
            <div class="formula-box">
                <table style="border: none; box-shadow: none;">
                    <tr>
                        <td style="border: none; text-align: right; padding: 0.5rem;">存贮费</td>
                        <td style="border: none; padding: 0.5rem;">$\frac{1}{2}C_1(P-R)(t_3 - t_2)(t - t_2)$</td>
                    </tr>
                    <tr>
                        <td style="border: none; text-align: right; padding: 0.5rem;">消去 $t_3$，得</td>
                        <td style="border: none; padding: 0.5rem;">$\frac{1}{2}C_1(P-R)\frac{R}{P}(t - t_2)^2$</td>
                    </tr>
                    <tr>
                        <td style="border: none; text-align: right; padding: 0.5rem;">缺货费</td>
                        <td style="border: none; padding: 0.5rem;">$\frac{1}{2}C_2Rt_1t_2$</td>
                    </tr>
                    <tr>
                        <td style="border: none; text-align: right; padding: 0.5rem;">消去 $t_1$，得</td>
                        <td style="border: none; padding: 0.5rem;">$\frac{1}{2}C_2R\frac{(P-R)}{P}t_2^2$</td>
                    </tr>
                    <tr>
                        <td style="border: none; text-align: right; padding: 0.5rem;">装配费</td>
                        <td style="border: none; padding: 0.5rem;">$C_3$</td>
                    </tr>
                </table>
            </div>
            
            <p>在 $[0,t]$ 时间内总平均费用</p>
            <div class="formula-box">
                $$C(t,t_2) = \frac{1}{t}[\frac{1}{2}C_1\frac{(P-R)R}{P}(t - t_2)^2 + \frac{1}{2}C_2\frac{(P-R)R}{P}t_2^2 + C_3]$$
                $$= \frac{1}{2}\frac{(P-R)R}{P}[C_1t - 2C_1t_2 + (C_1 + C_2)\frac{t_2^2}{t}] + \frac{C_3}{t}$$
            </div>
            
            <div class="formula-box">
                $$\frac{\partial C(t,t_2)}{\partial t} = \frac{1}{2}\frac{(P-R)R}{P}[C_1 + (C_1 + C_2)t_2^2(-\frac{1}{t^2})] - \frac{C_3}{t^2}$$
                $$\frac{\partial C(t,t_2)}{\partial t_2} = \frac{1}{2}\frac{(P-R)R}{P}[-2C_1 + 2(C_1 + C_2)t_2 \cdot \frac{1}{t}]$$
            </div>
            
            <p>由 $\frac{\partial C(t,t_2)}{\partial t_2} = 0$，得 $t_2 = \frac{C_1}{C_1 + C_2}t$。</p>
            
            <p>由 $\frac{\partial C(t,t_2)}{\partial t} = 0$，得</p>
            <div class="formula-box">
                $$\frac{1}{2}\frac{(P-R)R}{P}[C_1 + (C_1 + C_2)t_2^2(-\frac{1}{t^2})] - \frac{C_3}{t^2} = 0$$
            </div>
            
            <p>消去 $t_2$ 得</p>
            <div class="formula-box">
                $$\frac{1}{2}\frac{(P-R)R}{P}[C_1 - (C_1 + C_2)\frac{C_1^2}{(C_1 + C_2)^2}] - C_3\frac{1}{t^2} = 0$$
                $$\frac{1}{2}\frac{(P-R)R}{P}(\frac{C_1^2 + C_1C_2 - C_1^2}{C_1 + C_2}) - \frac{C_3}{t^2} = 0$$
                $$t^2 = \frac{2P(C_1 + C_2)C_3}{C_1C_2(P-R)R}$$
            </div>
            
            <p>则</p>
            <div class="formula-box">
                $$t = \sqrt{\frac{2C_3}{C_1R}} \cdot \sqrt{\frac{C_1 + C_2}{C_2}} \cdot \sqrt{\frac{P}{P-R}}, \text{记作 } t_0$$
            </div>
            
            <p>有</p>
            <div class="formula-box">
                $$t_2 = \frac{C_1}{C_1 + C_2}t_0 = \frac{C_1}{C_1 + C_2}\sqrt{\frac{2C_3}{C_1R}} \cdot \sqrt{\frac{C_1 + C_2}{C_2}} \cdot \sqrt{\frac{P}{P-R}}$$
            </div>
            
            <p>依数学分析的知识可以判定 $C(t,t_2)$ 在 $t = t_0, t_2 = \frac{C_1}{C_1 + C_2}t_0$ 时有最小值。</p>
            
            <p>相应地得到</p>
            <div class="formula-box">
                $$t_0 = \sqrt{\frac{2C_3}{C_1R}} \cdot \sqrt{\frac{C_1 + C_2}{C_2}} \cdot \sqrt{\frac{P}{P-R}}$$
                $$Q_0 = R \cdot t_0 = \sqrt{\frac{2C_3R}{C_1}} \cdot \sqrt{\frac{C_1 + C_2}{C_2}} \cdot \sqrt{\frac{P}{P-R}}$$
                $$S_0(\text{最大存贮量}) = R(t_0 - t_3) = R(t_0 - \frac{R}{P}t_0 - \frac{P-R}{P}t_2)$$
                $$= R[t_0 - \frac{R}{P}t_0 - \frac{(P-R)}{P} \cdot \frac{C_1}{(C_1 + C_2)}t_0]$$
                $$= R \cdot \frac{(P-R)}{P} \cdot \frac{C_2}{(C_1 + C_2)}t_0$$
                $$= \sqrt{\frac{2C_3R}{C_1}} \cdot \sqrt{\frac{C_2}{C_1 + C_2}} \cdot \sqrt{\frac{P-R}{P}}$$
            </div>
            
            <div class="formula-box">
                $$B_0(\text{最大缺货量}) = R \cdot t_1 = \frac{R(P-R)}{P} \cdot t_2$$
                $$= \sqrt{\frac{2C_1C_3R}{(C_1 + C_2)C_2}} \cdot \sqrt{\frac{P-R}{P}}$$
                $$\min C(t_0,t_2) = C_0 = \sqrt{2C_1C_3R} \cdot \sqrt{\frac{C_2}{C_1 + C_2}} \cdot \sqrt{\frac{P-R}{P}}$$
            </div>
        </section>
        
        <!-- 8.3 随机型库存模型 -->
        <section id="section3">
            <h2>8.3 随机型库存模型</h2>
            
            <p>8.2 节讨论的库存模型中的参数，即需求量及提前期，都是确定的。这一节讨论的几个模型的参数是随机的。</p>
            
            <!-- 8.3.1 单时期模型 -->
            <h3 id="section3-1">8.3.1 单时期无准备成本的库存模型</h3>
            
            <p>所谓单时期模型是指订货库存物资只满足一个特定时期需求的模型。这一节中只讨论这种单时期模型。先假设需求量是随机的，需求是瞬时的，补充也是瞬时的，而且无准备成本。在这些条件下，根据期望总成本最小的原则，去确定最佳储存策略，即确定最佳定货量 $Q^*$。</p>
            
            <h4>1. 需求是连续的随机变量</h4>
            
            <p>一些参数的符号如下：</p>
            <ul style="list-style-position: inside; margin-left: 2em;">
                <li>$I$ ——初始库存量；</li>
                <li>$Q$ ——订货量；</li>
                <li>$y$ ——订货补充后库存量，$y = Q + I$；</li>
                <li>$C_1$ ——这个时期内单位货物储存费；</li>
                <li>$C_2$ ——这个时期内单位货物缺货费，包括失去销售的机会损失和因缺货带来的损失；</li>
                <li>$K$ ——单位货成本价；</li>
                <li>$\xi$ ——需求量；</li>
                <li>$\varphi(\xi)$ ——需求量 $\xi$ 之概率密度函数。</li>
            </ul>
            
            <p>为了讨论方便，用最佳订货补充后库存量 $y^*$ 代替 $Q^*$，$y^* = I + Q^*$。确定了 $y^*$ 也就确定了 $Q^*$。因此首先要导出期望成本与 $y$ 之间的函数关系。由分析知，若补充后库存量为 $y$ 时，这时期储存量</p>
            
            <div class="formula-box">
                $$H(y) = \begin{cases} y - \xi, & \xi < y \\ 0, & \xi \geq y \end{cases}$$
            </div>
            
            <p>而缺货量</p>
            <div class="formula-box">
                $$G(y) = \begin{cases} 0, & \xi < y \\ \xi - y, & \xi \geq y \end{cases}$$
            </div>
            
            <p>则这个时期的期望成本费用</p>
            <div class="formula-box">
                $$E[C(y)] = \text{订货成本} + E[\text{储存费}] + E[\text{缺货费}]$$
                $$= K(y - I) + C_1\int_0^\infty H(y)\varphi(\xi)d\xi + C_2\int_0^\infty G(y)\varphi(\xi)d\xi$$
                $$= K(y - I) + C_1\int_0^y (y - \xi)\varphi(\xi)d\xi + C_2\int_y^\infty (\xi - y)\varphi(\xi)d\xi$$
            </div>
            
            <p>求解</p>
            <div class="formula-box">
                $$\frac{dE[C(y)]}{dy} = K + C_1\int_0^y \varphi(\xi)d\xi - C_2\int_y^\infty \varphi(\xi)d\xi = 0$$
            </div>
            
            <p>并利用</p>
            <div class="formula-box">
                $$\int_y^\infty \varphi(\xi)d\xi = 1 - \int_0^y \varphi(\xi)d\xi$$
            </div>
            
            <p>即得方程</p>
            <div class="formula-box">
                $$\int_0^y \varphi(\xi)d\xi = \frac{C_2 - K}{C_1 + C_2}$$
            </div>
            
            <p>由此解得满足方程的 $y^*$ 即为所求。（由于 $E[C(y)]$ 之二阶导数 $\frac{d^2E[C(y)]}{dy^2} = (C_1 + C_2)\varphi(y) > 0$，$E[C(y)]$ 为凸函数，有唯一最小点 $y$）</p>
            
            <p>按上述推导，确定最优 $y^*$，即确定 $y^*$ 值使 $\xi < y^*$ 的概率满足</p>
            <div class="formula-box">
                $$P(\xi < y) = \frac{C_2 - K}{C_1 + C_2} = q$$
            </div>
            
            <p>并称 $q$ 值为临界值。</p>
            
            <!-- 例题 8.4 -->
            <div class="example">
                <div class="example-title">📌 例 8.4</div>
                <p>已知单位储存费 $C_1 = 0.5$ 元，单位货价 $K = 0.5$ 元，单位缺货费 $C_2 = 4.5$ 元，初始库存量 $I = 0$，需求量密度函数是</p>
                <div class="formula-box">
                    $$\varphi(\xi) = \begin{cases} \frac{1}{10}, & 0 \leq \xi \leq 10 \\ 0, & \xi > 10 \end{cases}$$
                </div>
                <p>试求单时期模型最佳订货量。</p>
                
                <div class="solution">
                    <div class="solution-title">💡 解答</div>
                    <p>先计算</p>
                    <div class="formula-box">
                        $$q = \frac{C_2 - K}{C_1 + C_2} = \frac{4.5 - 0.5}{4.5 + 0.5} = 0.8$$
                        $$P(\xi \leq y) = \int_0^y \frac{1}{10}d\xi = \frac{1}{10}y = 0.8$$
                        $$y^* = 8$$
                        $$Q^* = y^* - I = 8 - 0 = 8$$
                    </div>
                </div>
            </div>
            
            <h4>2. 需求是随机离散的</h4>
            
            <p>如果需求量 $\xi$ 是离散的，则上述期望成本费用</p>
            <div class="formula-box">
                $$E[C(y)] = K(y - I) + C_1\sum_{i=0}^y (y - \xi)P(\xi) + C_2\sum_{\xi=y+1}^\infty (\xi - y)P(\xi)$$
            </div>
            
            <p>在离散情况下，可由下列不等式组确定最小点 $y^*$：</p>
            <div class="formula-box">
                $$E[C(y - 1)] \geq E[C(y)] \text{ 和 } E[C(y + 1)] \geq E[C(y)]$$
            </div>
            
            <div class="formula-box">
                $$E[C(y - 1)] = K(y - 1 - I) + C_1\sum_{\xi=0}^{y-1} (y - 1 - \xi)\varphi(\xi) + C_2\sum_{\xi=y}^\infty (\xi - y + 1)\varphi(\xi)$$
                $$= K(y - I) + C_1\sum_{\xi=0}^{y-1} (y - \xi)\varphi(\xi) + C_2\sum_{\xi=y}^\infty (\xi - y)\varphi(\xi) - C_1\sum_{\xi=0}^{y-1} \varphi(\xi) + C_2\sum_{\xi=y}^\infty \varphi(\xi) - K$$
                $$= E[C(y)] + C_2 - K - (C_1 + C_2)\sum_{\xi=0}^{y-1} \varphi(\xi)$$
            </div>
            
            <p>进一步得</p>
            <div class="formula-box">
                $$E[C(y - 1)] - E[C(y)] = C_2 - K - (C_1 + C_2)P(\xi \leq y - 1) \geq 0$$
            </div>
            
            <p>即</p>
            <div class="formula-box">
                $$P(\xi \leq y - 1) \leq \frac{C_2 - K}{C_1 + C_2}$$
            </div>
            
            <p>同样可由</p>
            <div class="formula-box">
                $$E[C(y + 1)] > E[C(y)]$$
            </div>
            
            <p>得</p>
            <div class="formula-box">
                $$P(\xi \leq y) \geq \frac{C_2 - K}{C_1 + C_2}$$
            </div>
            
            <p>由此得最小点 $y^*$ 必满足</p>
            <div class="formula-box">
                $$\sum_{\xi=0}^{y^*-1} \varphi(\xi) \leq \frac{C_2 - K}{C_1 + C_2} \leq \sum_{\xi=0}^{y^*} \varphi(\xi)$$
            </div>
            
            <!-- 例题 8.5 -->
            <div class="example">
                <div class="example-title">📌 例 8.5（报童问题）</div>
                <p>报童每天能售出的报数是不能预先确定的，是一个随机变量。每售出一份报能赚利润 $s$ 元。当天报本能售出，可退回报社，但每份报损失 $h$ 元；若当天报不够卖，必须从其他报贩处购进以保证供应，每份报批发为 $K$ 元。根据以往经验，得知每日能售出报数 $\xi$ 的概率为 $P(\xi)$，问报童每日应订购多少份报数为最佳？</p>
                
                <div class="solution">
                    <div class="solution-title">💡 解答</div>
                    <p>这显然是个单时期无准备成本的储存模型。设每日订购数为 $Q$ 份，则 $I = 0, y = Q$。可从两个角度来讨论：一是以期望总成本支付费用最少准则确定 $Q^*$；另一是以利润损失期望最小为准则确定 $Q^*$。先以期望总成本费用最少准则出发，确定最佳订货量 $Q^*$，有 $Q = y$，则进一步得</p>
                    
                    <p>期望利润损失 $E[C(y)] =$ 订报费用 $-$ 退回当日售不完报的回收费用 $+$ 从其他报贩购入当日缺货量的费用</p>
                    <div class="formula-box">
                        $$E[C(y)] = Ky - (K - h)\sum_{\xi=0}^y (y - \xi)P(\xi) + (K + s)\sum_{\xi=y+1}^\infty (\xi - y)P(\xi)$$
                    </div>
                    
                    <p>对照前面分析中的 $E[C(y)]$ 的表达式，相应于 $C_1 = h - K, C_2 = K + s$，求 $E[C(y)]$ 之最小值，即求不等式</p>
                    <div class="formula-box">
                        $$\sum_{\xi=0}^{y-1} P(\xi) \leq \frac{C_2 - K}{C_1 + C_2} = \frac{s}{h + s} \leq \sum_{\xi=0}^y P(\xi)$$
                    </div>
                    
                    <p>若已知 $s = 7, h = 4, \xi$ 概率分布如表 8.1 所示。</p>
                    
                    <table>
                        <caption style="caption-side: top; padding: 0.5rem; font-weight: 700;">表 8.1</caption>
                        <tr>
                            <th>$\xi(\text{千})$</th>
                            <th>0</th>
                            <th>1</th>
                            <th>2</th>
                            <th>3</th>
                            <th>4</th>
                            <th>5</th>
                        </tr>
                        <tr>
                            <td>$P(\xi)$</td>
                            <td>0.05</td>
                            <td>0.10</td>
                            <td>0.25</td>
                            <td>0.35</td>
                            <td>0.15</td>
                            <td>0.10</td>
                        </tr>
                    </table>
                    
                    <p>先计算临界值 $q = \frac{s}{h + s} = \frac{7}{4 + 7} = 0.637$，进一步得</p>
                    <div class="formula-box">
                        $$\sum_{\xi=0}^2 P(\xi) = 0.4 < 0.637 < \sum_{\xi=0}^3 P(\xi) = 0.75$$
                    </div>
                    
                    <p>所以 $y^* = 3$，即每日订货 3 000 张为最佳。</p>
                    
                    <p>同样，也可以从利润损失的角度出发来确定最佳订货量 $Q^*$。</p>
                    
                    <p>期望利润损失 $E[C(y)] =$ 利润损失 $+$ 缺货损失</p>
                    <div class="formula-box">
                        $$= h \cdot \sum_{\xi=0}^y (y - \xi)P(\xi) + s\sum_{\xi=y+1}^\infty (\xi - y)P(\xi)$$
                    </div>
                    
                    <p>由不等式</p>
                    <div class="formula-box">
                        $$E[C(y - 1)] > E[C(y)] \text{ 及 } E[C(y + 1)] > E[C(y)]$$
                    </div>
                    
                    <p>来确定 $y^*$ 值，类似前面分析得</p>
                    <div class="formula-box">
                        $$E[C(y + 1)] - E[C(y)] = h\sum_{\xi=0}^{y+1} (y + 1 - \xi)P(\xi) + s\sum_{\xi=y+2}^\infty (\xi - y - 1)P(\xi)$$
                        $$- h\sum_{\xi=0}^y (y - \xi)P(\xi) - s\sum_{\xi=y+1}^\infty (\xi - y)P(\xi)$$
                        $$= (h + s)\sum_{\xi=0}^y P(\xi) - s \geq 0$$
                    </div>
                    
                    <div class="formula-box">
                        $$\sum_{\xi=0}^y P(\xi) \geq \frac{s}{h + s}$$
                    </div>
                    
                    <p>同样可得</p>
                    <div class="formula-box">
                        $$E[C(y - 1)] - E[C(y)] = s - (h + s)\sum_{\xi=0}^{y-1} P(\xi) \geq 0$$
                    </div>
                    
                    <p>即可由</p>
                    <div class="formula-box">
                        $$\sum_{\xi=0}^{y-1} P(\xi) \leq \frac{s}{h + s} \leq \sum_{\xi=0}^y P(\xi)$$
                    </div>
                    
                    <p>从两个不同角度出发确定最佳值 $y^*$，结论是一致的。</p>
                </div>
            </div>
            
            <!-- 8.3.2 s-S策略 -->
            <h3 id="section3-2">8.3.2 单时期有准备成本库存模型（$s$-$S$ 策略）</h3>
            
            <h4>1. 需求是连续的随机变量</h4>
            
            <p>本节将讨论在有准备成本 $C_3$ 条件下的单时期库存模型。在这个模型中，应该解决两个问题：① 在初始库存 $I$ 条件下，该不该订货；② 若需订货的话，应该订多少最合适。对这两个问题的回答，仍然是根据期望总成本费最小的原则。在这个条件下储存系统的期望成本（初始库存为 $I$，订货量 $Q$，$y = Q + I$）</p>
            
            <div class="formula-box">
                $$E[C(y)] = \begin{cases}
                C_3 + K(y - I) + C_1\int_0^y (y - \xi)\varphi(\xi)d\xi + C_2\int_y^\infty (\xi - y)\varphi(\xi)d\xi, & \text{当 } y > I(\text{订购}) \\
                C_1\int_0^I (I - \xi)\varphi(\xi)d\xi + C_2\int_I^\infty (\xi - I)\varphi(\xi)d\xi, & \text{当 } y = I(\text{不订购})
                \end{cases}$$
            </div>
            
            <p>设</p>
            <div class="formula-box">
                $$L(y) = Ky + C_1\int_0^y (y - \xi)\varphi(\xi)d\xi + C_2\int_y^\infty (\xi - y)\varphi(\xi)d\xi$$
            </div>
            
            <p>则有</p>
            <div class="formula-box">
                $$E[C(y)] = \begin{cases}
                C_3 - KI + L(y), & y \geq I(\text{订购}) \\
                -KI + L(y), & y = I(\text{不订购})
                \end{cases}$$
            </div>
            
            <div style="background: #f7f7f7; padding: 1.5rem; border-radius: 10px; margin: 1.5rem 0;">
                <p style="text-indent: 0;"><strong>采用 $s$-$S$ 策略，即根据随机需求量 $\xi$ 确定 $s$ 和 $S$ 值。</strong>当期初库存 $I < s$ 时，采取订货策略，订货补充库存至 $S$，$S = I + Q$；当 $I > s$ 时，则不订货，目的是确定 $s$ 和 $S$ 值。</p>
                
                <p style="text-indent: 0;">首先确定 $S$ 值。由图 8.6 知，函数 $C_3 - KI + L(y)$，$-KI + L(y)$ 及函数 $L(y)$ 之极小点 $y$ 是一致的，取</p>
                <div class="formula-box">
                    $$S = y^*$$
                </div>
                
                <p style="text-indent: 0;">即由方程</p>
                <div class="formula-box">
                    $$\int_0^y \varphi(\xi)d\xi = \frac{C_2 - K}{C_1 + C_2}$$
                </div>
                
                <p style="text-indent: 0;">确定 $y^*, S = y^*$。</p>
            </div>
            
            <div class="diagram">
                <svg width="500" height="300" style="margin: 0 auto; display: block;">
                    <!-- 坐标轴 -->
                    <line x1="50" y1="250" x2="480" y2="250" stroke="#343434" stroke-width="2"/>
                    <line x1="50" y1="250" x2="50" y2="30" stroke="#343434" stroke-width="2"/>
                    <text x="485" y="255" font-size="14">y</text>
                    <text x="20" y="25" font-size="14">E[C(y)]</text>
                    
                    <!-- 曲线1: C₃ - KI + L(y) -->
                    <path d="M 80 100 Q 200 80 280 110 Q 320 120 400 160" stroke="#f27d00" stroke-width="3" fill="none"/>
                    <text x="320" y="95" font-size="12" fill="#f27d00">C₃-KI+L(y)</text>
                    
                    <!-- 曲线2: -KI + L(y) -->
                    <path d="M 80 180 Q 200 160 280 180 Q 320 190 400 230" stroke="#a6d6c9" stroke-width="3" fill="none"/>
                    <text x="320" y="210" font-size="12" fill="#a6d6c9">-KI+L(y)</text>
                    
                    <!-- 标记点 -->
                    <circle cx="120" cy="250" r="4" fill="#343434"/>
                    <text x="110" y="270" font-size="14">I</text>
                    
                    <circle cx="200" cy="250" r="4" fill="#343434"/>
                    <text x="190" y="270" font-size="14">s</text>
                    
                    <circle cx="280" cy="250" r="4" fill="#343434"/>
                    <text x="270" y="270" font-size="14">S</text>
                    
                    <!-- 最小值点 -->
                    <circle cx="200" cy="160" r="5" fill="#f27d00"/>
                    <circle cx="280" cy="180" r="5" fill="#a6d6c9"/>
                    
                    <line x1="280" y1="180" x2="280" y2="250" stroke="#343434" stroke-width="1" stroke-dasharray="5,5"/>
                </svg>
                <p class="diagram-caption">图 8.6 s-S策略示意图</p>
            </div>
            
            <p>其次，由方程 $L(s) = C_3 + L(S)$ 确定 $s$ 值（同时产生三个 $s$ 值，舍去 $s > S$ 之值）。然后论证，这样确定的 $s$-$S$ 值确实构成最优储存策略。分别从三种情况证明。</p>
            
            <p>① 当 $I < s$ 时，由 $L(y)$ 图形知，$L(I) > L(s)$，采取不订货策略时期望成本 $(Q = 0, y = I)$</p>
            <p>$E[C(I)] = -KI + L(I)$；采取订货策略，订货补充至 $y$，相应期望成本 $E[C(y)] = C_3 - KI + L(y)$。考虑其最小期望成本</p>
            <div class="formula-box">
                $$\min_{y>I} E[C(y)] = \min_{y>I} [C_3 - KI + L(y)] = C_3 - KI + L(y^*)$$
            </div>
            
            <p>其中，$y^*$ 为 $L(y)$ 之最小点，$S = y^*$，则得</p>
            <div class="formula-box">
                $$\min_{y>I} E[C(y)] = C_3 - KI + L(y^*) = -KI + L(s) < -KI + L(I) = E[C(I)]$$
            </div>
            
            <p>由此看出，当 $I < s$ 时，采取订货策略。订货补充至 $S$ 时，期望成本比不订货时的期望成本要小，所以应该采用订货至 $S$ 的策略。</p>
            
            <p>② 当 $s < I < S$ 时，由图 8.6 知 $L(I) < L(s)$。若采用订货策略时，即 $y > I$ 时，最小期望成本</p>
            <div class="formula-box">
                $$E[C(S)] = \min_{y>I} [C(y)] = C_3 - KI + L(y^*) = C_3 - KI + L(S)$$
            </div>
            
            <p>若采用不订货策略时，期望成本</p>
            <div class="formula-box">
                $$E[C(I)] = -KI + L(I) < -KI + L(s) = -KI + C_3 + L(S) = E[C(S)]$$
            </div>
            
            <p>所以当 $s < I < S$ 时，应采用不订货策略。</p>
            
            <p>③ 当 $S < I$ 时，任何订货使 $y > I$ 时，显然有</p>
            <div class="formula-box">
                $$E[C(y)] = C_3 - KI + L(y) > -KI + L(I) = E[C(I)]$$
            </div>
            
            <p>所以不订货为合适。</p>
            
            <p>归纳起来，对于初始库存为 $I$ 的单时期有准备成本的储存系统，最优储存策略为：</p>
            <p>① 当 $I > s$ 时，不订货；</p>
            <p>② 当 $I < s$ 时，订货，订货量为 $(S - I)$，其中 $S$ 是函数</p>
            <div class="formula-box">
                $$L(y) = Ky + \int_0^y C_1(y - \xi)\varphi(\xi)d\xi + C_2\int_y^\infty (\xi - y)\varphi(\xi)d\xi$$
            </div>
            
            <p>的极小点，可由方程</p>
            <div class="formula-box">
                $$\int_0^S \varphi(\xi)d\xi = \frac{C_2 - K}{C_1 + C_2}$$
            </div>
            
            <p>确定。</p>
            
            <p>$s$ 为方程</p>
            <div class="formula-box">
                $$L(s) = C_3 + L(S)$$
            </div>
            
            <p>的最小点，显然 $s$ 和 $S$ 与 $I$ 无关，只是与需求量 $\xi$ 之密度函数 $\varphi(\xi)$ 有关。</p>
            
            <!-- 例题 8.6 -->
            <div class="example">
                <div class="example-title">📌 例 8.6</div>
                <p>考虑例 8.4 中，若有准备费用 $C_3 = 9$ 时，试确定最优储存策略 $s$-$S$。</p>
                
                <div class="solution">
                    <div class="solution-title">💡 解答</div>
                    <p>由例 8.4 已确定 $y^* = 8$，则取 $S = 8$。进一步确定 $s$ 值，考虑函数</p>
                    <div class="formula-box">
                        $$L(y) = 0.5y + 0.5\int_0^y \frac{1}{10}(y - \xi)d\xi + 4.5\int_y^{10} \frac{1}{10}(\xi - y)d\xi$$
                        $$= 0.5y + 0.05(y\xi - \frac{\xi^2}{2})|_0^y + 0.45(\frac{\xi^2}{2} - y\xi)|_y^{10}$$
                        $$= 0.25y^2 - 4.0y + 22.5$$
                    </div>
                    
                    <p>由方程 $L(s) = C_3 + L(S)$ 得</p>
                    <div class="formula-box">
                        $$0.25s^2 - 4.0s + 22.5 = 9 + 0.25S^2 - 4.0S + 22.5$$
                        $$s^2 - 16s + 28 = 0$$
                    </div>
                    
                    <p>解为</p>
                    <div class="formula-box">
                        $$s_1 = 2, \quad s_2 = 14(\text{舍去})$$
                    </div>
                    
                    <p>最优策略为：当 $I < 2$ 时，应订货，订货量为 $Q^* = 8 - I$；当 $I > 2$ 时，不订货。</p>
                </div>
            </div>
            
            <h4>2. 需求是随机离散的</h4>
            
            <p>当需求量 $\xi$ 是离散取值时，订货补充至 $y$ 时的期望成本</p>
            <div class="formula-box">
                $$E[C(y)] = C_3 + K(y - I) + C_1\sum_{i<y} (y - \xi)\varphi(\xi) + C_2\sum_{j < \xi} (\xi - y)\varphi(\xi)$$
            </div>
            
            <p>完全类同前面的讨论，最佳值 $y^*$ 可由满足不等式</p>
            <div class="formula-box">
                $$\sum_{\xi=0}^{y^*-1} \varphi(\xi) \leq \frac{C_2 - K}{C_1 + C_2} \leq \sum_{\xi=0}^{y^*} \varphi(\xi)$$
            </div>
            
            <p>的 $y^*$ 值来确定。取 $S = y^*$，然后同样再确定 $s$ 值。设</p>
            <div class="formula-box">
                $$L(y) = Ky + C_1\sum_{i<y} (y - \xi)\varphi(\xi) + C_2\sum_{\xi>y} (\xi - y)\varphi(\xi)$$
            </div>
            
            <p>考察不等式</p>
            <div class="formula-box">
                $$L(y) \leq C_3 + L(S)$$
            </div>
            
            <p>取使不等式成立的最小 $y$ 值为 $s$ 值。</p>
            
            <!-- 例题 8.7 -->
            <div class="example">
                <div class="example-title">📌 例 8.7</div>
                <p>某工厂在某一阶段对原料需求量的概率为：$\varphi(\xi = 80) = 0.1$，$\varphi(\xi = 90) = 0.2$，$\varphi(\xi = 100) = 0.3$，$\varphi(\xi = 110) = 0.3$，$\varphi(\xi = 120) = 0.1$；订货准备费用 $C_3 = 2\ 825$ 元；货价 $K = 850$ 元；单位储存费用 $C_1 = 45$ 元；单位缺货费每件 $C_2 = 1\ 250$ 元。试确定该工厂在这一阶段中的最优储存策略。</p>
                
                <div class="solution">
                    <div class="solution-title">💡 解答</div>
                    <p>① 计算临界值</p>
                    <div class="formula-box">
                        $$q = \frac{C_2 - K}{C_1 + C_2} = \frac{1\ 250 - 850}{1\ 250 + 45} = 0.309$$
                    </div>
                    
                    <p>② 由计算</p>
                    <div class="formula-box">
                        $$\varphi(\xi = 80) + \varphi(\xi = 90) = 0.3 < 0.309 < 0.6 = \varphi(\xi = 80) + \varphi(\xi = 90) + \varphi(\xi = 100)$$
                    </div>
                    
                    <p>确定 $S = 100$。</p>
                    
                    <p>③ 用 $S = 100$ 代入</p>
                    <div class="formula-box">
                        $$L(s) \leq C_3 + L(S)$$
                    </div>
                    
                    <p>得</p>
                    <div class="formula-box">
                        $$L(s) \leq 2\ 825 + (850 \times 100) + 45 \times [(100 - 80) \times 0.1 + (100 - 90) \times 0.2 + (100 - 100) \times 0.3] + 1\ 250 \times [(110 - 100) \times 0.3 + (120 - 100) \times 0.1] = 94\ 255$$
                    </div>
                    
                    <p>由于 $s < S$，$s$ 只能取 80, 90 二值。以 $s = 80$ 代入计算得</p>
                    <div class="formula-box">
                        $$L(80) = (850 \times 80) + 45 \times (80 - 80) \times 0.1 + 1\ 250 \times [(90 - 80) \times 0.2 + (100 - 80) \times 0.3 + (110 - 80) \times 0.3 + (120 - 80) \times 0.1] = 94\ 250 < 94\ 255$$
                    </div>
                    
                    <p>所以取 $s = 80$。</p>
                    
                    <p>该厂储存策略应为：当初始库存 $I < 80$ 时，订货 $100 - I$；当 $I > 80$ 时，不订货。</p>
                </div>
            </div>
            
            <p>在单时期有准备成本模型中，当需求量 $\xi$ 具有负指数分布时，即</p>
            <div class="formula-box">
                $$\varphi(\xi) = \frac{1}{\lambda}e^{-\frac{\xi}{\lambda}}$$
            </div>
            
            <p>时，可使用简便的近似方法确定最优储存策略。</p>
            
            <p>确定 $S$ 值时，计算得</p>
            <div class="formula-box">
                $$\int_0^S \varphi(\xi)d\xi = 1 - e^{-\frac{S}{\lambda}} = \frac{C_2 - K}{C_1 + C_2}$$
                $$S = \lambda\ln\frac{C_1 + C_2}{C_1 + K}$$
            </div>
            
            <p>另外有</p>
            <div class="formula-box">
                $$L(y) = Ky + C_1\int_0^y (y - \xi)\frac{1}{\lambda}e^{-\frac{\xi}{\lambda}}d\xi + C_2\int_y^\infty (\xi - y)\frac{1}{\lambda}e^{-\frac{\xi}{\lambda}}d\xi$$
                $$= (K + C_1)y + \lambda(C_1 + C_2)e^{-\frac{y}{\lambda}} - \lambda C_1$$
            </div>
            
            <p>为求 $s$ 计算 $L(s) = C_3 + L(S)$，得</p>
            <div class="formula-box">
                $$(K + C_1)s + \lambda(C_1 + C_2)e^{-\frac{s}{\lambda}} - \lambda C_1 = C_3 + (K + C_1)S + \lambda(C_1 + C_2)e^{-\frac{S}{\lambda}} - \lambda C_1$$
                $$\frac{\lambda(C_1 + C_2)}{K + C_1}e^{-\frac{s}{\lambda}} = \frac{C_3}{K + C_1} + (S - s) + \frac{\lambda(C_1 + C_2)}{K + C_1}e^{-\frac{C_1 + C_2}{K + C_1}}$$
                $$e^{\ln\frac{C_1 + C_2}{K + C_1}}e^{-\frac{s}{\lambda}} = \frac{C_3}{\lambda(K + C_1)} + \frac{S - s}{\lambda} + 1$$
                $$e^{\frac{S - s}{\lambda}} = \frac{C_3}{\lambda(K + C_1)} + \frac{S - s}{\lambda} + 1$$
            </div>
            
            <p>当 $\frac{S - s}{\lambda}$ 很小时，左边按 Taylor 公式展开，舍去二次以后项得</p>
            <div class="formula-box">
                $$1 + \frac{S - s}{\lambda} + \frac{1}{2}(\frac{S - s}{\lambda})^2 \approx \frac{C_3}{\lambda(K + C_1)} + \frac{S - s}{\lambda} + 1$$
                $$S - s \approx \sqrt{\frac{2\lambda C_3}{K + C_1}}$$
            </div>
            
            <p>这样得确定 $s$-$S$ 的近似公式：</p>
            <div class="formula-box">
                $$S = \lambda\ln\frac{C_1 + C_2}{C_1 + K}$$
                $$s = S - \sqrt{\frac{2\lambda C_3}{K + C_1}} = \lambda\ln\frac{C_1 + C_2}{C_1 + K} - \sqrt{\frac{2\lambda C_3}{K + C_1}}$$
            </div>
            
            <!-- 8.3.3 随机需求与随机补充 -->
            <h3 id="section3-3">8.3.3 随机需求与随机补充时间的库存模型</h3>
            
            <p>这种模型连续观察库存量，当库存量下降至 $R$ 时，就订货，订货量为 $Q$。问题是要确定最优的 $R$ 和 $Q$ 值，使得储存系统在单位时间内期望总费用最小。这一模型假设：发出订货单到收到订货之间的提前时间（拖后时间）是随机的；需求量也是随机的。并设：</p>
            
            <ul style="list-style-position: inside; margin-left: 2em;">
                <li>$r(x | t)$ ——提前时间 $t$ 内需求量为 $x$ 的条件概率密度函数；</li>
                <li>$S(t)$ ——提前时间是 $t(t > 0)$ 的概率密度函数；</li>
                <li>$f(x)$ ——提前时间内需求量为 $x$ 的概率密度函数，且</li>
            </ul>
            
            <div class="formula-box">
                $$f(x) = \int_0^\infty r(x|t)S(t)dt$$
            </div>
            
            <ul style="list-style-position: inside; margin-left: 2em;">
                <li>$Q$ ——每个周期的定货量；</li>
                <li>$D$ ——每年的期望总需求量；</li>
                <li>$C_1$ ——每年每单位货物储存费；</li>
                <li>$C_2$ ——每次每单位的缺货费用。</li>
            </ul>
            
            <p>每年准备成本　$C_3 \cdot \frac{D}{Q}(\frac{D}{Q}$ 为每年大约订货次数)；</p>
            
            <p>每周期平均储存量　</p>
            <div class="formula-box">
                $$H = \frac{Q + E[R - x] + E[R - x]}{2}$$
                $$= \frac{Q}{2} + E[R - x]$$
                $$= \frac{Q}{2} + R - \int_0^\infty xf(x)dx$$
            </div>
            
            <p>全年储存费　$C_1[\frac{Q}{2} + R - \int_0^\infty xf(x)dx]$；</p>
            
            <p>每年周期期望缺货量　$S = \int_R^\infty (x - R)f(x)dx$；</p>
            
            <p>全年缺货费　$C_2S\frac{D}{Q}$</p>
            
            <p>年期望总费用 = 准备成本 + 期望储存费用 + 期望缺货费用，即</p>
            <div class="formula-box">
                $$C(Q,R) = C_3\frac{D}{Q} + C_1(\frac{Q}{2} + R - E[x]) + C_2S\frac{D}{Q}$$
            </div>
            
            <p>为求最优 $Q^*$ 和 $R^*$，计算</p>
            <div class="formula-box">
                $$\begin{cases}
                \frac{\partial C(Q,R)}{\partial Q} = -(\frac{C_3D}{Q^2}) + \frac{C_1}{2} - \frac{C_2SD}{Q^2} = 0 \\
                \frac{\partial C(Q,R)}{\partial R} = C_1 - (\frac{C_2D}{Q})\int_R^\infty f(x)dx = 0
                \end{cases}$$
            </div>
            
            <p>得</p>
            <div class="formula-box">
                $$\begin{cases}
                Q^* = \sqrt{\frac{2D(C_3 + C_2\overline{S})}{C_1}} & (1) \\
                \int_R^\infty f(x)dx = \frac{C_1Q^*}{C_2D} & (2)
                \end{cases}$$
            </div>
            
            <p>求解上述非线性方程组，可采用 Hadley 和 Whitin 提出的方法。只要解存在，此方法便可经有限次迭代收敛。</p>
            
            <p>首先导出解存在的充分条件。令 $R = 0$ 时，$\overline{S} = \int_0^\infty xf(x)dx = E[x]$，代入公式 (1) 得</p>
            <div class="formula-box">
                $$Q^* = \hat{Q} = \sqrt{\frac{2D(C_3 + C_2E[x])}{C_1}}$$
            </div>
            
            <p>由公式 (2) 得</p>
            <div class="formula-box">
                $$Q^* = \widetilde{Q} = \frac{C_2D}{C_1}$$
            </div>
            
            <p>可以证明，若 $\widetilde{Q} > \hat{Q}$ 时，满足式 (1) 和式 (2) 的 $Q^*$ 的 $R^*$ 存在且唯一。</p>
            
            <p>Hadley-Whitin 方法步骤如下：</p>
            
            <p>以 $S_0 = 0, Q_0 = \sqrt{\frac{2DC_3}{C_1}}$ 作 $Q^*$ 之初始值，代入式 (2) 得 $R_0$。由 $R_0$ 计算 $\overline{S}$ 值，得 $\overline{S}_1$，代入式 (1) 得 $Q_1$，重复，以 $Q_1$ 代入式 (2) 得 $R_1$。以此类推，直至相邻 $R_i$ 和 $R_{i+1}$ 近似相等，则最后得到的 $Q_{i+1}$ 和 $R_{i+1}$ 就近似作为 $Q^*$ 和 $R^*$。</p>
            
            <!-- 例题 8.8 -->
            <div class="example">
                <div class="example-title">📌 例 8.8</div>
                <p>某储存系统 $C_3 = 100, D = 1\ 000, C_1 = 2, C_2 = 10$，提前时间内需求量服从一个从 0 到 100 范围内的均匀分布，试确定最优储存策略。</p>
                
                <div class="solution">
                    <div class="solution-title">💡 解答</div>
                    <p>首先判断是否有解，取</p>
                    <div class="formula-box">
                        $$\hat{Q} = \sqrt{\frac{2D(C_3 + C_2E[x])}{C_1}} = \sqrt{\frac{2 \times 1\ 000 \times (100 + 10 \times 50)}{2}} = 774.6$$
                        $$\widetilde{Q} = \frac{C_2D}{C_1} = \frac{10 \times 1\ 000}{2} = 5\ 000$$
                    </div>
                    
                    <p>由于 $\widetilde{Q} > \hat{Q}$，则存在唯一 $Q^*$ 和 $R^*$，期望缺货量</p>
                    <div class="formula-box">
                        $$\overline{S} = \int_R^\infty (x - R)f(x)dx = \int_R^{100} (x - R)\frac{1}{100}dx = \frac{R^2}{200} - R + 50 \quad (3)$$
                    </div>
                    
                    <p>根据已知条件及式 (1)、式 (2) 得</p>
                    <div class="formula-box">
                        $$Q^* = \sqrt{\frac{2D(C_3 + C_2\overline{S})}{C_1}} = \sqrt{\frac{2 \times 1\ 000(100 + 10\overline{S})}{2}} \quad (4)$$
                        $$\int_{R^*}^{100} \frac{1}{100}dx = \frac{2Q^*}{10 \times 1\ 000}(\text{或 } R^* = 100 - \frac{Q^*}{50}) \quad (5)$$
                    </div>
                    
                    <p>将确定的 $Q_i$ 值代入式 (5) 得 $R_i$ 值，以 $R_i$ 值代入式 (3) 和式 (4) 得 $Q_{i+1}$，即有</p>
                    
                    <div class="formula-box">
                        $$\text{第一次迭代} \begin{cases}
                        Q_1 = \sqrt{\frac{2DC_3}{C_1}} = \sqrt{\frac{2 \times 1\ 000 \times 100}{2}} = 316 \\
                        R_1 = 100 - \frac{316}{50} = 93.68
                        \end{cases}$$
                    </div>
                    
                    <div class="formula-box">
                        $$\begin{cases}
                        \overline{S} = \frac{R_1^2}{200} - R_1 + 50 = 0.199\ 71 \\
                        \text{第二次迭代} \quad Q_2 = \sqrt{100\ 000 + 10\ 000 \times 0.199\ 71} = 319.37 \\
                        R_2 = 100 - \frac{319.37}{50} = 93.612
                        \end{cases}$$
                    </div>
                    
                    <div class="formula-box">
                        $$\begin{cases}
                        \overline{S} = \frac{R_2^2}{200} - R_2 + 50 = 0.204\ 03 \\
                        \text{第三次迭代} \quad Q_3 = \sqrt{100\ 000 + 10\ 000 \times 0.204\ 03} = 319.43 \\
                        R_3 = 100 - \frac{319.43}{50} = 93.611
                        \end{cases}$$
                    </div>
                    
                    <p>由于 $R_2 \approx R_3$，则最优解取 $R^* = 93.61, Q^* = 319.4$，即当库存量降至 93.61 时发出订单，订货量为 319.4。</p>
                </div>
            </div>
        </section>
        
        <!-- 习题部分 -->
        <section id="exercises" class="exercise">
            <h2>📝 习题 8</h2>
            
            <div style="margin-bottom: 1.5rem;">
                <h4>8.1</h4>
                <p>设某工厂每年需用某种原料 1 800 t，不需每日供应，但不得缺货。设每吨每日的保管费为 60 元，每次订购费为 200 元，试求最佳定购量。</p>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <h4>8.2</h4>
                <p>某公司采用无安全库存的存贮策略。每年使用基础零件 100 000 件，每件每年的保管费用为 3 元，每次订购费为 60 元，试求：(1) 购批量；(2) 如每次订购费为 0.60 元，此次订购多少？</p>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <h4>8.3</h4>
                <p>设某工厂生产某种零件，每年需要量为 18 000 个，该厂每月可生产 3 000 个，每次生产的装配费为 500 元，每个零件的存贮费为 0.15 元，求每次生产的最佳批量。</p>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <h4>8.4</h4>
                <p>某产品每月用量为 4 件，装配费为 50 元，存贮费每月每件为 8 元，求产品每次最佳生产量及最小费用。若生产速度为每月 10 件，求每次生产量及最小费用。</p>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <h4>8.5</h4>
                <p>每月需要某种机械零件 2 000 件，每件成本 150 元，每年的存贮费用为成本的 16%，每次订购费 100 元，求 EOQ 及最小费用。</p>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <h4>8.6</h4>
                <p>在题 8.5 中如允许缺货，求库存量 $s$ 及最大缺货量，设缺货费 $C_2 = 200$ 元。</p>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <h4>8.7</h4>
                <p>某制造厂每周购某种机械零件 50 件，订购费为 4 元，每周保管费为 0.36 元。(1) 求 EOQ。(2) 该厂为少占用流动资金，希望存贮量达到最低限度，决定宁可稍总费用超过最低费用的 4% 作为存贮策略，问这时订购批量为多少？</p>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <h4>8.8</h4>
                <p>某公司经理一贯采用不允许缺货的经济批量公式确定订货批量，因为他认为缺货后补上总不是好事。但由于激烈竞争导致他不得不考虑采用允许缺货的策略。已知对该公司所销产品的需求 $R = 800$ 件/年，每次订货费用 $C_3 = 150$ 元，存贮费 $C_1 = 3$ 元/(件·年)，发生短缺时的损失 $C_2 = 20$ 元/(件·年)。试分析：(1) 计算采用允许缺货的策略较之原先不允许缺货策略带来的费用上的节约；(2) 如果该公司为保持一定信誉，自己规定缺货随后补上的数量不超过总量的 15%，任何一名顾客因供应不及时需等下批货到达补上的时间不得超过 3 周，问该情况下，允许缺货的策略能否被采用？</p>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <h4>8.9</h4>
                <p>某商店准备在新年前订购一批挂历发出售，已知每售出一批（100 本）可获利 70 元。如果挂历在新年时不能销售完 100 本，售价 40 元。根据以往销售经验，该商店售出挂历数量的概率和表 8.2 所示。如果该商店对挂历只能提供一次订货，问应订几百本，使期望利润为最大。</p>
                
                <table style="margin-top: 1rem;">
                    <caption style="caption-side: top; padding: 0.5rem; font-weight: 700;">表 8.2</caption>
                    <tr>
                        <th>销售量（百本）</th>
                        <th>0</th>
                        <th>1</th>
                        <th>2</th>
                        <th>3</th>
                        <th>4</th>
                        <th>5</th>
                    </tr>
                    <tr>
                        <td>概率</td>
                        <td>0.05</td>
                        <td>0.10</td>
                        <td>0.25</td>
                        <td>0.35</td>
                        <td>0.15</td>
                        <td>0.10</td>
                    </tr>
                </table>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <h4>8.10</h4>
                <p>某商店代销一种产品，每件产品的购进价格为 800 元，存贮费每件 40 元，缺货费每件 1 015 元，订购费一次 60 元，原有库存 10 件。已知对产品需求的概率见表 8.3。试确定该商店的最佳订货数量。</p>
                
                <table style="margin-top: 1rem;">
                    <caption style="caption-side: top; padding: 0.5rem; font-weight: 700;">表 8.3</caption>
                    <tr>
                        <th>需求量 $x$</th>
                        <th>30</th>
                        <th>40</th>
                        <th>50</th>
                        <th>60</th>
                    </tr>
                    <tr>
                        <td>$P(x)$</td>
                        <td>0.20</td>
                        <td>0.20</td>
                        <td>0.40</td>
                        <td>0.20</td>
                    </tr>
                </table>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <h4>8.11</h4>
                <p>某商店存有某种商品 10 件，每件的进价为 3 元，存贮费为 1 元，缺货费为 16 元。已知对该种商品的需求量服从 $\mu = 20, \sigma = 5$ 的正态分布，求商店对该种商品的最佳订货量。</p>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <h4>8.12</h4>
                <p>某商店准备订购一批圣诞树迎接节日，据历年经验，销量服从正态分布，$\mu = 200, \sigma^2 = 300$。每棵圣诞树价为 25 元，进价为 15 元。如果进了货卖不出去，则节后以最少的角度出卖来确定最佳订货量 $Q^*$。</p>
            </div>
            
            <div style="margin-bottom: 1.5rem;">
                <h4>8.13</h4>
                <p>填空</p>
                <p>在确定性贮藏问题中，记 $C_1$ 为存贮费，$C_2$ 为缺货费，$C_3$ 为订货费，$R$ 为需求率。设 $C_1, C_2, C_3$ 和 $R$ 均为常数，不需要提前订货，且一订货即可全部供货，则不允许缺货时最佳批量相应的单位时间总费用为 $C = $ ________，允许缺货（缺货要补）时最佳批量相应的单位时间总费用为 $C = $ ________；二者的大小关系为 $C$ ________（$\geq$ 或 $\leq$）$C$。</p>
            </div>
        </section>
        
        <!-- 结尾说明 -->
        <section style="background: linear-gradient(135deg, #a6d6c9 0%, #ffffff 100%); border: 2px solid #f27d00;">
            <h2 style="color: #f27d00;">📖 使用说明</h2>
            <div style="padding: 1rem; background: white; border-radius: 10px; margin-top: 1rem;">
                <h3 style="background: none; border: none; padding: 0; margin-bottom: 1rem;">如何使用本教程：</h3>
                <ol style="list-style-position: inside; line-height: 2;">
                    <li><strong>保存文件：</strong>将本HTML页面保存为 <code>库存决策教程.html</code> 文件</li>
                    <li><strong>网络要求：</strong>需要连接互联网以加载 MathJax 数学公式渲染库和 Google Fonts 字体</li>
                    <li><strong>浏览器打开：</strong>使用现代浏览器（Chrome、Firefox、Edge、Safari等）打开HTML文件</li>
                    <li><strong>交互操作：</strong>点击折叠面板可展开查看详细内容</li>
                    <li><strong>导航使用：</strong>使用左侧导航栏快速跳转到不同章节</li>
                    <li><strong>数学公式：</strong>所有数学公式使用标准LaTeX格式，由MathJax自动渲染</li>
                </ol>
                
                <h3 style="background: none; border: none; padding: 0; margin: 1.5rem 0 1rem 0;">⚠️ 重要提示：</h3>
                <ul style="list-style-position: inside; line-height: 2;">
                    <li>首次加载可能需要几秒钟时间来渲染数学公式</li>
                    <li>如果公式显示不正常，请检查网络连接并刷新页面</li>
                    <li>建议使用桌面浏览器以获得最佳浏览体验</li>
                    <li>移动设备上也可正常浏览，但公式可能需要横向滚动</li>
                </ul>
            </div>
        </section>
    </div>
    
    <script>
        // 平滑滚动
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
        
        // 移动端侧边栏切换
        const sidebar = document.getElementById('sidebar');
        let touchStartX = 0;
        
        document.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
        });
        
        document.addEventListener('touchend', (e) => {
            const touchEndX = e.changedTouches[0].clientX;
            if (touchStartX < 50 && touchEndX > 150) {
                sidebar.classList.add('active');
            } else if (touchStartX > 250 && touchEndX < 100) {
                sidebar.classList.remove('active');
            }
        });
        
        // 点击内容区域关闭侧边栏（移动端）
        document.querySelector('.container').addEventListener('click', () => {
            if (window.innerWidth <= 768) {
                sidebar.classList.remove('active');
            }
        });
        
        // 高亮当前章节
        const sections = document.querySelectorAll('section');
        const navLinks = document.querySelectorAll('.sidebar a');
        
        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (pageYOffset >= sectionTop - 100) {
                    current = section.getAttribute('id');
                }
            });
            
            navLinks.forEach(link => {
                link.style.background = '';
                link.style.color = '#343434';
                if (link.getAttribute('href') === `#${current}`) {
                    link.style.background = '#a6d6c9';
                    link.style.color = '#ffffff';
                }
            });
        });
    </script>
</body>
</html>
<!-- 
========================================
文件创建说明：
========================================
✅ 本HTML文件包含完整的第8章库存决策教程内容
✅ 所有数学公式使用正确的LaTeX格式（$...$ 和 $$...$$）
✅ MathJax配置完整且正确
✅ 使用指定的配色方案：#f27d00, #a6d6c9, #f7d117, #ffffff, #343434
✅ 包含交互式折叠面板、侧边导航、平滑滚动等功能
✅ 响应式设计，支持桌面和移动设备
✅ 包含所有例题和习题
✅ 文件编码为UTF-8

========================================
使用步骤：
========================================
1. 保存为 .html 文件
2. 确保有网络连接（加载MathJax和Google Fonts）
3. 用浏览器打开文件
4. 首次加载需要几秒钟渲染数学公式

========================================
数学公式验证：
========================================
✅ 所有公式使用 $ 或 $$ 包围
✅ 所有LaTeX命令正确（\sum, \int, \frac, \sqrt等）
✅ 希腊字母使用反斜杠（\mu, \sigma, \xi等）
✅ 分数使用\frac{}{}格式
✅ 上下标使用^和_符号
✅ 复杂公式正确分块

-->